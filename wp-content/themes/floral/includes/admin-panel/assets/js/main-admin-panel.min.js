var floral_ap={};!function(a){"use strict";var b=["Prepare","Check Theme Requirement","Check Libraries","Check Data Files","Import Options","Import Data Demo || Import Categories","Import Data Demo || Import Tags","Import Data Demo || Import Terms","Import Data Demo || Import Posts","Import Data Demo || Update Info and Cleanup","Import Updates","Generate CSS","Import Revolution Sliders","End"];floral_ap.install_demo={is_installing:!1,current_phase:0,current_process:0,time_spent:0,onReady:function(){floral_ap.install_demo.show_log(),floral_ap.install_demo.trigger_install(),floral_ap.install_demo.progress_bar_work()},show_log:function(){a("html").append('<div id="log-dialog" title="Install Demo Data Log"></div>');var b=a("a#button-show-log"),c=a("div#log-dialog");c.dialog({autoOpen:!1,maxHeight:600,maxWidth:600,height:300,width:400,open:function(c,d){a(c.target).parent().css("position","fixed").position({my:"right bottom",at:"left top",of:b})},resize:function(c,d){a(c.target).parent().position({my:"right bottom",at:"left top",of:b})},position:{my:"right bottom",at:"left top",of:b}}),b.on("click",function(a){a.preventDefault(),c.dialog("isOpen")?c.dialog("close"):c.dialog("open")}),this.add_log("Hi there, this is 9WPThemes!")},add_log:function(b,c){var d=["info","error","warning","success"],e=a("div#log-dialog");b="undefined"!=typeof b?b:"",c="undefined"!=typeof c?c:"info",d.indexOf(c)==-1&&(c="info"),e.length>0&&e.prepend('<p class="'+c+'"><strong>'+(new Date).toLocaleTimeString()+":-</strong><span> "+b+"</span></p>")},show_message:function(b,c){a("html").append('<div class="auto-generated-dialog"><div>'+c+"</div></div>");var d=a(".auto-generated-dialog");d.dialog({modal:!0,width:400,buttons:{"Got it!":function(){a(this).dialog("close"),a(this).remove()}}})},show_install_success_message:function(b,c){a("html").append('<div class="auto-generated-dialog">Install demo data: '+c+' finish success.<br/> <strong>Check out the site now!</strong><p style="margin-top: 10px"><i>Total time spent: '+floral_ap.install_demo.time_spent/1e3+"(s)</i></p></div>");var d=a(".auto-generated-dialog");d.dialog({modal:!0,width:400,buttons:{"Check Out The Site":function(){var b=window.open(floral_ap_object.home_url,"_blank");b.focus(),a(this).dialog("close")},Cancel:function(){a(this).dialog("close")}},close:function(b,c){location.reload(!0),a(this).remove()}})},install_demo:function(c,d,e,f,g,h){floral_ap.install_demo.is_installing=!0;var i={action:"install_demo_data",demo_name:d,demo_path:e,phase:f,dummy:g,options:h},j=a(c).parents(".demo-item-inner").find(".progressbar");floral_ap.install_demo.spinner_on(c),a.ajax({type:"POST",data:i,url:floral_ap_object.ajax_url,success:function(f){try{if(f=a.parseJSON(f),f.phase=parseInt(f.phase),floral_ap.install_demo.current_phase=f.phase,floral_ap.install_demo.add_log("MESSAGE: <i>"+f.message+"</i><br/>PROCESS: <i>"+f.process+"</i><br/>PHASE: <i>"+b[f.phase]+"</i>",f.status),"error"==f.status)floral_ap.install_demo.add_log("The installation has been stopped, please try again!",f.status),floral_ap.install_demo.show_message(this,'<p class="error"><strong>The installation has been stopped.</strong><br/><strong style="color: red;">Message: '+f.message+"</strong><br/><br/><i>Hit the show log button for more information!</i></p>"),floral_ap.install_demo.spinner_off(c),floral_ap.install_demo.reset_data(),floral_ap.install_demo.animate_progress_bar(j,floral_ap.install_demo.current_process);else{if(1==f.phase&&"warning"==f.status){var g=confirm("Some server configurations do not meet theme recommended requirement, force install? (Be careful, the installation can be stuck some where!)");if(!g)return floral_ap.install_demo.add_log("The installation has been stopped, please check out the System Status for more information!","error"),floral_ap.install_demo.show_message(this,'<p class="error"><strong>The installation has been stopped.<br/> Please check out the System Status for more information!</strong></p>'),floral_ap.install_demo.spinner_off(c),floral_ap.install_demo.reset_data(),void floral_ap.install_demo.animate_progress_bar(j,floral_ap.install_demo.current_process)}if("complete"==f.process)if(f.phase<b.length-1){switch(f.phase){case 0:floral_ap.install_demo.current_process=0;break;case 1:floral_ap.install_demo.current_process=1;break;case 2:floral_ap.install_demo.current_process=2;break;case 3:floral_ap.install_demo.current_process=3;break;case 4:floral_ap.install_demo.current_process=18;break;case 5:floral_ap.install_demo.current_process=23;break;case 6:floral_ap.install_demo.current_process=28;break;case 7:floral_ap.install_demo.current_process=33;break;case 8:floral_ap.install_demo.current_process=63;break;case 9:floral_ap.install_demo.current_process=68;break;case 10:floral_ap.install_demo.current_process=78;break;case 11:floral_ap.install_demo.current_process=83;break;case 12:floral_ap.install_demo.current_process=100;break;default:floral_ap.install_demo.current_process=100}floral_ap.install_demo.animate_progress_bar(j,floral_ap.install_demo.current_process),floral_ap.install_demo.install_demo(c,d,e,1+f.phase,f.process,h)}else floral_ap.install_demo.current_process=100,floral_ap.install_demo.animate_progress_bar(j,floral_ap.install_demo.current_process),floral_ap.install_demo.time_spent=(new Date).getTime()-floral_ap.install_demo.time_spent,floral_ap.install_demo.show_install_success_message(c,d),floral_ap.install_demo.spinner_off(c),floral_ap.install_demo.reset_data();else{var i=f.process.split("||");if(12==f.phase){var k=i[0],l=i.length-1;floral_ap.install_demo.current_process+=l/k*100*.17,floral_ap.install_demo.animate_progress_bar(j,floral_ap.install_demo.current_process)}if(8==f.phase&&i.length>=2){var m=i[1],n=i[0],o=floral_ap.install_demo.current_process+n/m*100*.3;floral_ap.install_demo.animate_progress_bar(j,o)}floral_ap.install_demo.install_demo(c,d,e,f.phase,f.process,h)}}}catch(a){floral_ap.install_demo.add_log("The installation has been stopped, due to an unexpected response. <br/> DETAIL: "+a+"<br/> RESPONSE: <pre>"+f+"</pre>","error"),floral_ap.install_demo.show_message(this,'<p class="error"><strong>The installation has been stopped, due to an unexpected response.<br/> Please hit the show log button for more information!</strong></p>'),floral_ap.install_demo.spinner_off(c),floral_ap.install_demo.reset_data(),floral_ap.install_demo.animate_progress_bar(j,floral_ap.install_demo.current_process)}},error:function(a){floral_ap.install_demo.add_log("ERROR: "+a.statusText,"error "),console.log(a),floral_ap.install_demo.spinner_off(c),floral_ap.install_demo.reset_data(),floral_ap.install_demo.animate_progress_bar(j,floral_ap.install_demo.current_process)}})},trigger_install:function(){var b=a(".button-install");b.each(function(){var b=a(this);b.on("click",function(c){if(c.preventDefault(),b.hasClass("disabled"))floral_ap.install_demo.show_message(this,"You currently can not install this demo data!");else if(floral_ap.install_demo.is_installing)floral_ap.install_demo.show_message(this,"The installation is in process, please be patient!!");else{var d=b.attr("data-demo"),e=b.attr("data-path"),f=b.parent().find("span.demo-title").text(),g=a("#confirm-install-demo");g.length>0&&(g.find("span.demo-title").text(f),g.find("input#demo-data").on("change",function(){a(this).is(":checked")?g.find("input#fetching-demo-images").attr("checked","checked"):g.find("input#fetching-demo-images").prop("checked",!1)}),g.dialog({modal:!0,width:500,open:function(b,c){a(this).find("input#demo-data").attr("checked","checked"),a(this).find("input#fetching-demo-images").attr("checked","checked"),a(this).find("input#demo-options").attr("checked","checked"),a(this).find("input#demo-revslider").attr("checked","checked")},buttons:{"I understand, just install it.":function(){var c=a(this).parents(".demo-item-inner").find(".progressbar");if(d){floral_ap.install_demo.animate_progress_bar(c,floral_ap.install_demo.current_process),floral_ap.install_demo.time_spent=(new Date).getTime();var g=a(this).find("input#demo-options").is(":checked")?1:0,h=a(this).find("input#demo-data").is(":checked")?1:0,i=a(this).find("input#fetching-demo-images").is(":checked")?1:0,j=a(this).find("input#demo-revslider").is(":checked")?1:0,k=g+"||"+h+"||"+i+"||"+j,l="";if(0==h&&0==g&&0==j)return a(this).dialog("close"),floral_ap.install_demo.add_log("<b>No import options selected</b>, the installation can not start! Please try again."),void floral_ap.install_demo.show_message(b,"No options selected, the installation can not start! <br/> Please try again.");1==h&&(l+="<br/> - Demo data",l+=1==i?" and fetching images from our server":" and no fetching images from our server"),1==g&&(l+="<br/> - Demo options"),1==j&&(l+="<br/> - Demo revolution slider"),floral_ap.install_demo.add_log("Installing Demo Data: <b>"+f+"</b><br/>Your selected options : <b>"+l+"</b>"),floral_ap.install_demo.install_demo(b,d,e,floral_ap.install_demo.current_phase,"",k)}else floral_ap.install_demo.show_message(b,"Fail to start the installer! Demo data does not exist.");a(this).dialog("close")},Cancel:function(){a(this).dialog("close")}}}))}})})},progress_bar_work:function(){a(".progressbar").progressbar({value:0})},animate_progress_bar:function(a,b){a.progressbar("value",b)},disable_other_demo:function(b){a(".demo-item-inner").each(function(){var c=a(this).find(".button-install");c[0]!==b&&a(this).find(".dismiss-overlay").css("display","block")})},release_all_demo:function(){a(".dismiss-overlay").css("display","none")},reset_data:function(){this.current_phase=0,this.current_process=0,this.time_spent=0,this.is_installing=!1},spinner_on:function(b){a(b).parent().find("span.spinner").css("visibility","inherit")},spinner_off:function(b){a(b).parent().find("span.spinner").css("visibility","hidden")}},floral_ap.other_product={onReady:function(){floral_ap.other_product.trigger_load_more()},trigger_load_more:function(){var b=a("#tp-load-more");b.on("click",function(a){a.preventDefault(),floral_ap.other_product.load_theme_product(this)}),b.trigger("click")},load_theme_product:function(b){var c=a(".product-list"),d=a(b).attr("data-paged"),e=a(b).parent(".load-more-product");e.addClass("loading");var f={action:"load_theme_product",paged:d,post_num:5};a.ajax({type:"POST",data:f,url:floral_ap_object.ajax_url,success:function(f){if(a(b).attr("data-paged",parseInt(d)+1),""==f)e.append("<strong>NO MORE PRODUCTS TO SHOW.</strong>"),a(b).remove();else{var g=a(f).hide().fadeIn(1e3);c.append(g)}e.removeClass("loading")},error:function(c){e.append("<strong>NO MORE PRODUCTS TO SHOW.</strong>"),a(b).remove(),e.removeClass("loading")}})}},a(document).ready(function(){floral_ap.install_demo.onReady(),floral_ap.other_product.onReady()})}(jQuery);