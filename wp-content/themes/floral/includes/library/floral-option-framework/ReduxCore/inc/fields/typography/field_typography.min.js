!function(e){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{};var t=[],a=!1,r={width:"100%",allowClear:!0,theme:"classic"};redux.field_objects.typography.init=function(s,p){s||(s=e(document).find(".redux-group-tab:visible").find(".redux-container-typography:visible")),e(s).each(function(){var s,p=e(this),o=p;(p.hasClass("redux-field-container")||(o=p.parents(".redux-field-container:first")),o.is(":hidden"))||o.hasClass("redux-field-init")&&(o.removeClass("redux-field-init"),p.each(function(){e(this).find(".redux-typography-container").each(function(){var o=e(this).find(".redux-typography-family");void 0===o.attr("data-value")?o=e(this):""!==o.attr("data-value")&&e(o).val(o.attr("data-value")).trigger("change.select2");var l=e(this).find(".select2_params");if(l.size()>0){var y=l.val();y=JSON.parse(y),r=e.extend({},r,y)}s=Boolean(e(this).find(".redux-font-clear").val());var i,d=e(this).find(".redux-typography-family").parents(".redux-container-typography:first").attr("data-id"),h=e("#"+d+" .redux-typography-font-family").data("user-fonts");h=h?1:0;var n=e("#"+d+" .redux-typography-google").val();n=n?1:0;var u,g,c=[];if(void 0!==redux.customfonts&&c.push(redux.customfonts),void 0!==redux.stdfonts&&0===h&&c.push(redux.stdfonts),1==h){var f=[];for(var x in redux.typography[d]){var v=redux.typography[d].std_font;for(var b in v)v.hasOwnProperty(b)&&f.push({id:b,text:b,"data-google":"false"})}var m={text:"Standard Fonts",children:f};c.push(m)}(1==n||!0===n&&void 0!==redux.googlefonts)&&c.push(redux.googlefonts),i=c,u=r,g=e(this).find(".redux-typography-family").attr("placeholder");var w=e(this).find(".redux-typography-family").attr("data-value");u.data=i,u.placeholder=g,u.allowClear=s,e(this).find(".redux-typography-family").select2(u),u.data=null,e(this).find(".redux-typography-family").val(w).trigger("change.select2"),p.find(".redux-typography-family").hasClass("redux-typography-family")||(g=e(this).find(".redux-typography-align").attr("placeholder"),u.placeholder=g,p.find(".redux-typography-style").select2(u)),g=e(this).find(".redux-typography-align").attr("placeholder"),u.placeholder=g,e(this).find(".redux-typography-align").select2(u),g=e(this).find(".redux-typography-family-backup").attr("placeholder"),u.placeholder=g,e(this).find(".redux-typography-family-backup").select2(u),g=e(this).find(".redux-typography-transform").attr("placeholder"),u.placeholder=g,e(this).find(".redux-typography-transform").select2(u),g=e(this).find(".redux-typography-font-variant").attr("placeholder"),u.placeholder=g,e(this).find(".redux-typography-font-variant").select2(u),g=e(this).find(".redux-typography-decoration").attr("placeholder"),u.placeholder=g,e(this).find(".redux-typography-decoration").select2(u),redux.field_objects.typography.select(o,!0,!1,null,!0),e(this).find(".redux-typography-family, .redux-typography-family-backup, .redux-typography-style, .redux-typography-subsets, .redux-typography-align").on("change",function(r){var s=e(this).attr("id");if(e(this).hasClass("redux-typography-family")){if(e("#"+s).val()){var p,o=e(this).select2("data");p=o?o[0].text:null;e("#"+s);e("#"+s).attr("data-value",p),t=o[0],a=!0,redux.field_objects.typography.select(e("#"+s),!0,!1,p,!0)}}else{r=e("#"+s).val();e("#"+s).attr("data-value",r),(e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&(e("#"+s+' option[selected="selected"]').removeAttr("selected"),e("#"+s+' option[value="'+r+'"]').attr("selected","selected")),e(this).hasClass("redux-typography-subsets")&&e("#"+s).siblings(".typography-subsets").val(r),redux.field_objects.typography.select(e(this),!0,!1,null,!1)}}),e(this).find(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter").keyup(function(){redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}),e(this).find(".redux-typography-color").wpColorPicker({change:function(t,a){e(this).val(a.color.toString()),redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}}),e(this).find(".redux-typography-size").numeric({allowMinus:!1}),e(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0}),e(this).find(".redux-typography").on("select2:unselecting",function(t,a){var r=e(this).attr("id");e("#"+r).attr("data-value",""),e(this).hasClass("redux-typography-family")?(e(this).val(null).trigger("change.select2"),redux.field_objects.typography.select(e("#"+r),!0,!1,null,!0)):((e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&e("#"+r+' option[selected="selected"]').removeAttr("selected"),e(this).hasClass("redux-typography-subsets")&&e("#"+r).siblings(".typography-subsets").val(""),e(this).hasClass("redux-typography-family-backup")&&e("#"+r).val(null).trigger("change.select2"),redux.field_objects.typography.select(e(this),!0,!1,null,!1))}),window.onbeforeunload=null})}))})},redux.field_objects.typography.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a},redux.field_objects.typography.makeBool=function(e){return"false"!=e&&"0"!=e&&!1!==e&&0!==e&&("true"==e||"1"==e||!0===e||1==e||void 0)},redux.field_objects.typography.contrastColour=function(e){var t="#444444";""!==e&&(e=e.replace("#",""),t=(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3>=128?"#444444":"#ffffff");return t},redux.field_objects.typography.select=function(s,p,o,l,y){var i;void 0===(i=e(s).parents(".redux-container-typography:first").attr("data-id"))&&(i=e(s).attr("data-id"));e(s).parents(".redux-container-typography:first");var d=e("#"+i+"-family").val();d||(d=null),l&&(d=l);var h=e("#"+i+" select.redux-typography-family-backup").val(),n=e("#"+i+" .redux-typography-size").val(),u=e("#"+i+" .redux-typography-height").val(),g=e("#"+i+" .redux-typography-word").val(),c=e("#"+i+" .redux-typography-letter").val(),f=e("#"+i+" select.redux-typography-align").val(),x=e("#"+i+" select.redux-typography-transform").val(),v=e("#"+i+" select.redux-typography-font-variant").val(),b=e("#"+i+" select.redux-typography-decoration").val(),m=e("#"+i+" select.redux-typography-style").val(),w=e("#"+i+" select.redux-typography-subsets").val(),C=e("#"+i+" .redux-typography-color").val(),_=e("#"+i).data("units");if(y){var j;!0===a?(j=redux.field_objects.typography.makeBool(t["data-google"]),e("#"+i+" .redux-typography-google-font").val(j)):j=redux.field_objects.typography.makeBool(e("#"+i+" .redux-typography-google-font").val()),e("#"+i).hasClass("typography-initialized")||(m=e("#"+i+" select.redux-typography-style").attr("data-value"),w=e("#"+i+" select.redux-typography-subsets").attr("data-value"),""!==m&&(m=String(m)),void 0!==typeof w&&(w=String(w))),void 0===redux.fonts.google&&(j=!1);var k="";k=!0===j&&d in redux.fonts.google?redux.fonts.google[d]:{400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"},e(s).hasClass("redux-typography-subsets")&&e("#"+i+" input.typography-subsets").val(w)}if(e(s).hasClass("redux-typography-family")){var z='<option value=""></option>';if(!0===j){var I="";e.each(k.variants,function(e,t){t.id===m||1===redux.field_objects.typography.size(k.variants)?(I=' selected="selected"',m=t.id):I="",z+='<option value="'+t.id+'"'+I+">"+t.name.replace(/\+/g," ")+"</option>"}),o&&e("#"+i+" .redux-typography-style").select2("destroy"),e("#"+i+" .redux-typography-style").html(z);var B=e("#"+i+" .redux-typography-style").attr("placeholder");(O=r).placeholder=B,e("#"+i+" .redux-typography-style").select2(O),O.placeholder=null,I="",z='<option value=""></option>',e.each(k.subsets,function(t,a){a.id===w||1===redux.field_objects.typography.size(k.subsets)?(I=' selected="selected"',w=a.id,e("#"+i+" input.typography-subsets").val(w)):I="",z+='<option value="'+a.id+'"'+I+">"+a.name.replace(/\+/g," ")+"</option>"}),o&&e("#"+i+" .redux-typography-subsets").select2("destroy"),e("#"+i+" .redux-typography-subsets").html(z),B=e("#"+i+" .redux-typography-subsets").attr("placeholder"),(O=r).placeholder=B,e("#"+i+" .redux-typography-subsets").select2(O),O.placeholder=null,e("#"+i+" .redux-typography-subsets").parent().fadeIn("fast"),e("#"+i+" .typography-family-backup").fadeIn("fast")}else{var O;if(k)e.each(k,function(t,a){t===m||"normal"===t?(I=' selected="selected"',e("#"+i+" .typography-style select2-selection__rendered").text(a)):I="",z+='<option value="'+t+'"'+I+">"+a.replace("+"," ")+"</option>"}),o&&e("#"+i+" .redux-typography-style").select2("destroy"),e("#"+i+" .redux-typography-style").html(z),B=e("#"+i+" .redux-typography-style").attr("placeholder"),(O=r).placeholder=B,e("#"+i+" .redux-typography-style").select2(O),O.placeholder=null,e("#"+i+" .redux-typography-subsets").parent().fadeOut("fast"),e("#"+i+" .typography-family-backup").fadeOut("fast")}e("#"+i+" .redux-typography-font-family").val(d)}else e(s).hasClass("redux-typography-family-backup")&&""!==h&&e("#"+i+" .redux-typography-font-family-backup").val(h);if(y&&(0===e("#"+i+" select.redux-typography-style option[value='"+m+"']").length?(m="",e("#"+i+" select.redux-typography-style").val("").trigger("change.select2")):"400"===m&&e("#"+i+" select.redux-typography-style").val(m).trigger("change.select2"),0===e("#"+i+" select.redux-typography-subsets option[value='"+w+"']").length&&(w="",e("#"+i+" select.redux-typography-subsets").val("").trigger("change.select2"),e("#"+i+" input.typography-subsets").val(w))),e("."+("style_link_"+i)).remove(),null!==d&&"inherit"!==d&&e("#"+i).hasClass("typography-initialized")){var S=d.replace(/\s+/g,"+");if(!0===j){var F=S;m&&""!==m&&(F+=":"+m.replace(/\-/g," ")),w&&""!==w&&(F+="&subset="+w),!1===a&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[F]}}),e("#"+i+" .redux-typography-google").val(!0)}else e("#"+i+" .redux-typography-google").val(!1)}(m&&(-1!==m.indexOf("italic")?(e("#"+i+" .typography-preview").css("font-style","italic"),e("#"+i+" .typography-font-style").val("italic"),m=m.replace("italic","")):(e("#"+i+" .typography-preview").css("font-style","normal"),e("#"+i+" .typography-font-style").val("")),e("#"+i+" .typography-font-weight").val(m)),u||(u=n),""===n||void 0===n?e("#"+i+" .typography-font-size").val(""):e("#"+i+" .typography-font-size").val(n+_),""===u||void 0===u?e("#"+i+" .typography-line-height").val(""):e("#"+i+" .typography-line-height").val(u+_),""===g||void 0===g?e("#"+i+" .typography-word-spacing").val(""):e("#"+i+" .typography-word-spacing").val(g+_),""===c||void 0===c?e("#"+i+" .typography-letter-spacing").val(""):e("#"+i+" .typography-letter-spacing").val(c+_),e("#"+i).hasClass("typography-initialized"))&&("0"==e("#"+i+" .typography-preview").data("preview-size")&&e("#"+i+" .typography-preview").css("font-size",n+_),e("#"+i+" .typography-preview").css("font-weight",m),e("#"+i+" .typography-preview").css("font-family",d+", sans-serif"),"none"===d&&""===d&&e("#"+i+" .typography-preview").css("font-family","inherit"),e("#"+i+" .typography-preview").css("line-height",u+_),e("#"+i+" .typography-preview").css("word-spacing",g+_),e("#"+i+" .typography-preview").css("letter-spacing",c+_),C&&(e("#"+i+" .typography-preview").css("color",C),e("#"+i+" .typography-preview").css("background-color",redux.field_objects.typography.contrastColour(C))),e("#"+i+" .typography-style select2-selection__rendered").text(e("#"+i+" .redux-typography-style option:selected").text()),e("#"+i+" .typography-script select2-selection__rendered").text(e("#"+i+" .redux-typography-subsets option:selected").text()),f&&e("#"+i+" .typography-preview").css("text-align",f),x&&e("#"+i+" .typography-preview").css("text-transform",x),v&&e("#"+i+" .typography-preview").css("font-variant",v),b&&e("#"+i+" .typography-preview").css("text-decoration",b),e("#"+i+" .typography-preview").slideDown());e("#"+i).hasClass("typography-initialized")||e("#"+i).addClass("typography-initialized"),a=!1,p||redux_change(s)}}(jQuery);