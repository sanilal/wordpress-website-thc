var floral_admin={};!function(e,t){"use strict";var i=e(document.body);floral_admin={onReady:function(){e(document).on("widget-added",floral_admin.widget_select2),e(document).on("widget-updated",floral_admin.widget_select2),floral_admin.widget_select2(),floral_admin.select2_type_multi_remove_selected(),e(document).on("widget-added",floral_admin.widget_do_slider),e(document).on("widget-updated",floral_admin.widget_do_slider),floral_admin.widget_do_slider(),e(document).on("widget-added widget-updated",floral_admin.widget_file_selector),floral_admin.widget_file_selector(),e(document).on("widget-added widget-updated",floral_admin.widget_color_picker),floral_admin.widget_color_picker(),e(document).on("widget-added widget-updated",function(){floral_admin.widget_dependency()}),floral_admin.widget_dependency()},advance_menu:function(t,i,n){function a(){c.removeClass("active");var i=o.serialize();e.post(ajaxurl,{action:"floral_save_advance_menu_item_setting",floral_menu_item_id:t,floral_menu_item_submit_data:i},function(e){""==e?r.dialog("close"):alert(e)});var n=e("#menu-item-"+t);n.addClass("floral-edited"),setTimeout(function(){n.removeClass("floral-edited")},2500)}function l(){e("body").addClass("advance-menu-on"),e.post(ajaxurl,{action:"floral_get_advance_menu_item_setting",floral_menu_item_id:t,floral_menu_item_depth:i},function(e){o.html(e),c.addClass("active")})}var o=e("#floral-advance-menu-form"),c=e("#floral-advance-menu-form-container");o.on("submit",function(e){e.preventDefault(),a()});var r=e("#floral-advance-menu-form-container").dialog({autoOpen:!1,height:700,width:500,modal:!0,title:n,buttons:{Save:a,Cancel:function(){r.dialog("close")}},open:l,close:function(){c.removeClass("active"),e("body").removeClass("advance-menu-on")}});r.dialog("open")},icon_picker:function(t){e(".floral-icon-picker"+(t=void 0!==t?t:"")).each(function(t){function i(e){var t=e.find(".icon-container.active i").attr("class");t&&(s.val(t),f.attr("class",t))}function n(){s.val(""),f.attr("class","")}function a(e){var t=s.val();if(t){var i="."+t.replace(" ",".");e.find(i).parent(".icon-container").addClass("active")}}function l(t){var i,n='<div class="'+h+'"data-icon-picker-lib="'+t+'"><div class="floral-waiting-overlay"><span class="spinner"></span></div><div class="floral-icon-picker-filter-wrapper"><input type="text" class="floral-icon-picker-filter"/></div><style class="floral-inline-filter-style"></style><div class="floral-icon-picker-content"></div></div>';return i=e("body").append(n).children("."+h+'[data-icon-picker-lib="'+t+'"]'),e.post(ajaxurl,{action:"floral_html_icon_list",floral_icon_picker_lib:t},function(n){i.find(".floral-icon-picker-content").html(n),i.addClass("floral-remove-waiting"),i.find(".icon-container").on("click",function(t){t.preventDefault(),e(this).addClass("active").siblings().removeClass("active")});var a=i.find(".floral-inline-filter-style");i.find(".floral-icon-picker-filter").on("keyup",function(i){var n=e(this).val();if(n){var l="."+h+'[data-icon-picker-lib="'+t+'"] .floral-icon-picker-content .icon-container:not([title*="'+n+'"]){display : none;}';a.html(l)}else a.html("")})}),i}function o(){var t=d.val();if((i=e("."+h+'[data-icon-picker-lib="'+t+'"]')).length<1)var i=l(t);return i}function c(){var e=o(),t=e.dialog({autoOpen:!1,width:800,height:800,modal:!0,open:function(){a(e);var t=e,i=t.find(".floral-icon-picker-filter-wrapper");t.find(".floral-icon-picker-content").css({"max-height":t.height()-i.height(),overflow:"auto"})},buttons:{Select:function(){i(e),t.dialog("close")},Cancel:function(){t.dialog("close")}},close:function(){e.find(".icon-container").removeClass("active")}});t.dialog("open")}var r=e(this),d=r.find(".floral-icon-picker-lib"),s=r.find(".picker-input"),f=r.find(".picker-preview i"),u=r.find(".picker-pick"),p=r.find(".picker-remove"),h="floral_icon_picker_table";d.find("option[value="+d.val()+"]").attr("selected",!0),u.on("click",function(e){e.preventDefault(),c()}),p.on("click",function(e){e.preventDefault(),n()})})},media_picker:function(t){e(".floral-media-picker"+(t=void 0!==t?t:"")).each(function(t){function i(){o||n(),o.open()}function n(){(o=wp.media({title:"Select or Upload Media",button:{text:"Use this media"},multiple:f})).on("select",function(){var e=o.state().get("selection").toJSON(),t=[],i=[];if(u){var n=s.html(),a=d.val();n.length>0&&t.push(n),a.length>0&&i.push(a)}for(var l in e)t.push('<img src="'+e[l].url+'" alt=""/>'),i.push(e[l].url);s.html(t.join("")),d.val(i.join("||"))})}function a(){s.html(""),d.val("")}var l=e(this),o=!1,c=l.find(".floral-select-button"),r=l.find(".floral-reset-button"),d=l.find(".floral-media-input"),s=l.find(".floral-preview-area"),f=!!l.data("multiple"),u=!!l.data("add-selection");c.on("click",function(e){e.preventDefault(),i()}),r.on("click",function(e){e.preventDefault(),a()})})},widget_file_selector:function(t,i){void 0===i?e("#widgets-right").length>0?e("#widgets-right .floral-file-selector:not(.ready)").each(function(){floral_admin.file_selector(e(this))}):e(".floral-file-selector:not(.ready)").each(function(){floral_admin.file_selector(e(this))}):e(".floral-file-selector:not(.ready)",i).each(function(){floral_admin.file_selector(e(this))})},file_selector:function(t){void 0===t&&(t=e(".floral-file-selector:not(.ready)")),t.each(function(){function t(){var e=n.find("img");e.length>0&&e.remove()}function i(){0==a&&(a=wp.media({title:"Select or Upload Media",button:{text:"Use this media"},multiple:!1})).on("select",function(){l&&t();var e=a.state().get("selection").first().toJSON();l&&n.append('<img class="widget-image-selected" src="'+e.url+'" alt=""/>'),r.val(e.url)}),a.open()}var n=e(this),a=!1,l=!!n.hasClass("floral-image-selector"),o=n.find(".selector-btn"),c=n.find(".remove-btn"),r=n.find('input[type="text"]');n.addClass("ready"),o.on("click",function(){i()}),c.on("click",function(){r.val(null),l&&t()})})},widget_color_picker:function(t,i){void 0===i?e("#widgets-right").length>0?e("#widgets-right .floral-color-picker:not(.ready)").each(function(){floral_admin.color_picker(e(this))}):e(".floral-color-picker:not(.ready)").each(function(){floral_admin.color_picker(e(this))}):e(".floral-color-picker:not(.ready)",i).each(function(){floral_admin.color_picker(e(this))})},color_picker:function(t){void 0===t&&(t=e(".floral-color-picker:not(.ready)")),t.each(function(){e(this).find(".color-init").wpColorPicker({change:function(t,i){e(this).val(i.color.toString())},clear:function(t,i){e(this).val("")}}).addClass("ready")})},widget_select2:function(t,i){void 0===i?e("#widgets-right").length>0?(e("#widgets-right select.widget-select2:not(.select2-ready)").each(function(){floral_admin.widget_select2_item(this)}),e("#widgets-right select.single-select2:not(.select2-ready)").each(function(){floral_admin.select2_type_single(this)})):(e("select.widget-select2:not(.select2-ready)").each(function(){floral_admin.widget_select2_item(this)}),e("select.single-select2:not(.select2-ready)").each(function(){floral_admin.select2_type_single(this)})):(e("select.widget-select2:not(.select2-ready)",i).each(function(){floral_admin.widget_select2_item(this)}),e("select.single-select2:not(.select2-ready)",i).each(function(){floral_admin.select2_type_single(this)}))},widget_select2_item:function(t){e(t).addClass("select2-ready");var i=e(t).attr("data-value"),n=[];if(""!=i)for(var a=i.split("||"),l=0;l<a.length;l++){e("option[value="+a[l]+"]",t);n[l]=a[l]}e(t).select2({width:"100%",closeOnSelect:!0,minimumResultsForSearch:20}),e(t).val(n).trigger("change");var o=e(t).parent().find('input[type="checkbox"]'),c=e(t).find("option"),r=e(t).parent().find('input[type="hidden"]'),d=function(e){o.length&&(c.length==e?o.prop("checked",!0):o.prop("checked",!1))};d(r.val().split("||").length),o.length&&o.on("click",function(i){if(o.prop("checked")){var n="";c.each(function(t,i){e(this).prop("selected","selected"),0!=t&&(n+="||"),""!=i&&(n+=e(this).val())}),e(t).change(),r.val(n)}else c.removeAttr("selected"),e(t).change(),r.val(null)}),e(t).on("select2:select",function(t){var i=e('input[type="hidden"]',e(this).parent()).val();""!=i&&(i+="||"),i+=t.params.data.id,e('input[type="hidden"]',e(this).parent()).val(i),d(i.split("||").length)}).on("select2:unselect",function(t){for(var i=e('input[type="hidden"]',e(this).parent()).val().split("||"),n="",a=0;a<i.length;a++)i[a]!=t.params.data.id&&(""!=n&&(n+="||"),n+=i[a]);e('input[type="hidden"]',e(this).parent()).val(n),d(n.split("||").length)})},select2_type_multi_remove_selected:function(){e("select[multiple=multiple]").each(function(){e(this).on("select2:select",function(t){var i=t.params.data.element,n=e(i);n.detach(),e(this).append(n),e(this).trigger("change")})})},select2_type_single:function(t){e(t).addClass("select2-ready");var i=e(t).attr("data-value"),n="";""!=i&&(n=i),e(t).select2({width:"100%"}),e(t).val(n).trigger("change"),e(t).on("select2:select",function(t){var i=t.params.data.id;e('input[type="hidden"]',e(this).parent()).val(i)})},do_switcher:function(t){t.length>0&&t.each(function(){function t(e){return i.find("input#"+e).val()}var i=e(this),n=i.find('input[type="hidden"]');i.buttonset(),i.find("label").each(function(){var i=e(this),a=i.attr("for");i.on("click",function(){n.val(t(a)),n.trigger("change")})})})},widget_do_slider:function(){e("#widgets-right .floral-param-slider:not(.slider-ready)").each(function(){floral_admin.do_slider(e(this))})},do_slider:function(t){t.length>0&&t.each(function(){var t=e(this),i=t.find(".slider-object"),n=t.find(".slider-value"),a=t.attr("data-slider");t.addClass("slider-ready");try{a=e.parseJSON(a)}catch(e){a={unit:"",min:0,max:1,step:.1}}var l=n.val();""!==a.unit&&(l=l.replace(a.unit,"")),l=parseFloat(l),isNaN(l)?(l=a.min,n.val(l+a.unit)):(l<a.min&&(l=a.min),l>a.max&&(l=a.max)),i.slider({value:l,min:a.min,max:a.max,step:a.step,slide:function(e,t){n.val(t.value+a.unit)}})})},do_buttonset:function(t){t.length>0&&t.each(function(){function i(e){return n.find("input#"+e).val()}var n=e(this),a=n.find('input[type="hidden"]'),l=t.attr("data-multiple");n.buttonset(),n.find("label").each(function(){var t=e(this),n=t.attr("for");t.on("click",function(){var o=a.val(),c=i(n),r=o.split("||"),d=e.inArray(c,r);"true"==l?(t.hasClass("ui-state-active")?(d>-1&&r.splice(d,1),o=r.join("||")):""==o?o=c:-1==d&&(o+="||"+c),a.val(o)):a.val(c),a.trigger("change")})})})},widget_dependency:function(){i.hasClass("widgets-php")&&e(".widget-content:not(dep-ready)").each(function(){function t(t){function a(t){t||(t=e("#"+d));var a=t.parents(".widget-field-wrapper"),l=n(t);if(null!==l)if(s)if(i(l,s)){"none"!==a.css("display")&&r.slideDown();for(o=0;o<u.length;o++){p=u[o].attr("data-id");e("#"+p).trigger("change")}}else r.slideUp(),c();else if(f)if(i(l,f))r.slideUp(),c();else{"none"!==a.css("display")&&r.slideDown();for(var o=0;o<u.length;o++){var p=u[o].attr("data-id");e("#"+p).trigger("change")}}}function o(t){var i=t.attr("data-id"),n=[];return i&&l.each(function(){var t=e(this).attr("dep_el");i==t&&(n.push(e(this)),n=n.concat(o(e(this))))}),n}function c(){for(var e=0;e<u.length;e++)u[e].slideUp()}if(t){var r=t,d=r.attr("dep_el"),s=r.attr("dep_equal_to"),f=r.attr("dep_not_equal_to"),u=o(r);u.push(r),d&&(s||f)&&(a(),e("#"+d).on("change",function(){a(e(this))}))}}function i(e,t){return"object"==typeof e?-1!==e.indexOf(t):e==t}function n(e){switch(e.attr("data-type")){case"text":case"number":case"select":case"textarea":case"number-slider":case"file-selector":case"image-selector":case"icon-picker":case"multi-select":case"colorpicker":return e.val();case"checkbox":return e.is(":checked");default:return null}}var a=e(this),l=a.find(".widget-field-wrapper");a.addClass("dep-ready"),l.each(function(){t(e(this))})})}},e(document).ready(function(){floral_admin.onReady()})}(jQuery,window);